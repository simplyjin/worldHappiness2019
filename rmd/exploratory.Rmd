---
title: "Exploratory"
author: "Jin Chen"
date: "8/25/2020"
output: html_document
---
```{r}
library(tidyverse)
library(corrplot)
```

```{r}
#https://www.kaggle.com/unsdsn/world-happiness
wh_2015 <- read.csv("2015.csv") %>% 
  select(Country = Country,
         Rank = Happiness.Rank,
         Score = Happiness.Score,
         Economy = Economy..GDP.per.Capita.,
         Family,
         Health = Health..Life.Expectancy.,
         Freedom,
         GovernmentTrust = Trust..Government.Corruption.,
         Generosity)
wh_2016 <- read.csv("2016.csv") %>% 
  select(Country,
         Rank = Happiness.Rank,
         Score = Happiness.Score,
         Economy = Economy..GDP.per.Capita.,
         Family = Family,
         Health = Health..Life.Expectancy.,
         Freedom = Freedom,
         GovernmentTrust = Trust..Government.Corruption.,
         Generosity)
wh_2017 <- read.csv("2017.csv") %>% 
  select(Country,
         Rank = Happiness.Rank,
         Score = Happiness.Score,
         Economy = Economy..GDP.per.Capita.,
         Family = Family,
         Health = Health..Life.Expectancy.,
         Freedom = Freedom,
         GovernmentTrust = Trust..Government.Corruption.,
         Generosity)
wh_2018 <- read.csv("2018.csv") %>% 
  select(Country = Country.or.region,
         Rank = Overall.rank,
         Score,
         Economy = GDP.per.capita,
         Family = Social.support,
         Health = Healthy.life.expectancy,
         Freedom = Freedom.to.make.life.choices,
         GovernmentTrust = Perceptions.of.corruption,
         Generosity)
wh_2019 <- read.csv("2019.csv") %>% 
    select(Country = Country.or.region,
         Rank = Overall.rank,
         Score,
         Economy = GDP.per.capita,
         Family = Social.support,
         Health = Healthy.life.expectancy,
         Freedom = Freedom.to.make.life.choices,
         GovernmentTrust = Perceptions.of.corruption,
         Generosity)

wh_2015 <- wh_2015 %>% 
  mutate(year = 2015)

wh_2016 <- wh_2016 %>% 
  mutate(year = 2016)

wh_2017 <- wh_2017 %>% 
  mutate(year = 2017)

wh_2018 <- wh_2018 %>% 
  mutate(year = 2018,
         GovernmentTrust = as.numeric(as.character(GovernmentTrust)))

wh_2019 <- wh_2019 %>% 
  mutate(year = 2019)


wh_combined <- bind_rows(wh_2015, wh_2016, wh_2017, wh_2018, wh_2019)

wh_combined %>% 
  select(Country, GovernmentTrust) %>% 
  filter(Country == "United Arab Emirates") %>% 
  summarize(mean = mean(GovernmentTrust, na.rm = TRUE))

wh_combined <- wh_combined %>% 
  group_by(Country) %>% 
  mutate(GovernmentTrust= replace(GovernmentTrust, is.na(GovernmentTrust), mean(GovernmentTrust, na.rm=TRUE)))

wh_combined %>% 
  filter(is.na(GovernmentTrust))



```

```{r}
Num.cols <- sapply(wh_combined, is.numeric)
Cor.data <- cor(wh_combined[c(3:9)])
psych::cor.plot(Cor.data, method = 'color')  
corrplot(Cor.data, method = "color")  
corrplot(Cor.data, method = "number", type = "upper")  


```

